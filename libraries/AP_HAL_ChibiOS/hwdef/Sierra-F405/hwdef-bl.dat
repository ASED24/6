# hw definition for Sierra-F405 node

# MCU class and specific type
MCU STM32F4xx STM32F405xx

# crystal frequency
OSCILLATOR_HZ 16000000

# board ID for firmware load
APJ_BOARD_ID 1052

# setup build for a peripheral firmware
env AP_PERIPH 1

FLASH_RESERVE_START_KB 0
FLASH_SIZE_KB 1024
FLASH_BOOTLOADER_LOAD_KB 64

PB0 LED_BOOTLOADER OUTPUT LOW GPIO(0)  # blue
define HAL_LED_ON 0

# order of UARTs
SERIAL_ORDER USART1 USART2

# USART2
PA2 USART2_TX USART2 SPEED_HIGH NODMA
PA3 USART2_RX USART2 SPEED_HIGH NODMA

# USART1
PA9  USART1_TX USART1 SPEED_HIGH NODMA
PA10 USART1_RX USART1 SPEED_HIGH NODMA

# enable CAN support
PA11 CAN1_RX CAN1
PA12 CAN1_TX CAN1
#PB1 GPIO_CAN1_SILENT OUTPUT PUSHPULL SPEED_LOW LOW
CAN_ORDER 1
define HAL_USE_CAN1 TRUE
define STM32_CAN_USE_CAN1 TRUE

define CAN_APP_NODE_NAME "org.ardupilot.Sierra-F405"

# debugger support
PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD


# Add CS pins to ensure they are high in bootloader
PA8 BARO_CS CS
PB12  MAG_CS CS

# Enable the GPS voltage pin
PC13 GPS_EN OUTPUT HIGH

define HAL_CUSTOM_CLOCK_TREE
define STM32_PLLM_VALUE 8
define STM32_PLLN_VALUE 168
define STM32_PLLP_VALUE 2
define STM32_PLLQ_VALUE 4
